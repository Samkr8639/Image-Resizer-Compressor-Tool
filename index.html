<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Resizer & Compressor | Free Online Tool for Web Optimization</title>
    <meta name="description" content="Free online tool to resize and compress images. Optimize your photos for web, reduce file size without quality loss. Supports JPG, PNG, WebP formats.">
    <meta name="keywords" content="image resizer, image compressor, photo optimization, web image optimizer, reduce image size, resize photos">
    <meta name="author" content="ImageTools Pro">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="canonical" href="https://yoursite.com/image-resizer-compressor" />
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --accent: #f72585;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #4bb543;
            --gray: #6c757d;
            --border-radius: 12px;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark);
            min-height: 100vh;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            color: white;
        }

        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            font-weight: 800;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 20px;
            font-weight: 400;
        }

        .app-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 40px;
        }

        .controls {
            flex: 1;
            min-width: 320px;
        }

        .image-preview {
            flex: 2;
            min-width: 320px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .preview-box {
            flex: 1;
            min-width: 250px;
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .preview-box h3 {
            margin-bottom: 15px;
            font-weight: 600;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .image-placeholder {
            width: 100%;
            height: 250px;
            background: #f8f9fa;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray);
            font-size: 1rem;
            overflow: hidden;
            border: 2px dashed #e9ecef;
            transition: var(--transition);
        }

        .image-placeholder.has-image {
            border-color: var(--success);
        }

        .image-placeholder img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .control-group {
            margin-bottom: 25px;
            padding: 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .control-group h3 {
            margin-bottom: 15px;
            font-weight: 600;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .upload-area {
            border: 2px dashed #dee2e6;
            border-radius: var(--border-radius);
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            background: #f8f9fa;
        }

        .upload-area:hover, .upload-area.dragover {
            background: #e9ecef;
            border-color: var(--primary);
        }

        .upload-area i {
            font-size: 3.5rem;
            margin-bottom: 15px;
            color: var(--primary);
            opacity: 0.7;
        }

        .upload-area p {
            margin-bottom: 15px;
            color: var(--gray);
        }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(67, 97, 238, 0.3);
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(67, 97, 238, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-download {
            background: var(--success);
            width: 100%;
            justify-content: center;
            margin-top: 20px;
            padding: 16px;
            font-size: 1.1rem;
            box-shadow: 0 4px 12px rgba(75, 181, 67, 0.3);
        }

        .btn-download:hover {
            background: #3fa337;
            box-shadow: 0 6px 16px rgba(75, 181, 67, 0.4);
        }

        .btn-secondary {
            background: var(--secondary);
            box-shadow: 0 4px 12px rgba(114, 9, 183, 0.3);
        }

        .btn-secondary:hover {
            background: #6418a8;
            box-shadow: 0 6px 16px rgba(114, 9, 183, 0.4);
        }

        .slider-container {
            margin-bottom: 20px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            background: #e9ecef;
            border-radius: 5px;
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        .slider::-webkit-slider-thumb:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
        }

        .file-info {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .info-item {
            text-align: center;
            flex: 1;
        }

        .info-label {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
        }

        .reduction {
            color: var(--success);
        }

        .hidden {
            display: none;
        }

        .format-options {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .format-btn {
            flex: 1;
            padding: 12px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-weight: 500;
            transition: var(--transition);
        }

        .format-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(67, 97, 238, 0.2);
            border-left: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        footer {
            text-align: center;
            color: white;
            padding: 20px;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .feature-highlights {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 30px;
        }

        .feature {
            flex: 1;
            min-width: 200px;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            color: white;
        }

        .feature i {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
        }

        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .preview-container {
                flex-direction: column;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
            }
        }

        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8rem;
            font-weight: normal;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .dimension-inputs {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .dimension-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            text-align: center;
        }

        .dimension-input:focus {
            border-color: var(--primary);
            outline: none;
        }
        
        .seo-content {
            background: rgba(255, 255, 255, 0.9);
            border-radius: var(--border-radius);
            padding: 30px;
            margin-top: 40px;
            color: var(--dark);
        }
        
        .seo-content h2 {
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .seo-content h3 {
            color: var(--secondary);
            margin: 20px 0 10px;
        }
        
        .seo-content p {
            margin-bottom: 15px;
        }
        
        .seo-content ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Image Resizer & Compressor</h1>
            <p class="subtitle">Optimize your images for web with our free online tool. Reduce file size without losing quality.</p>
        </header>
        
        <div class="app-container">
            <div class="controls">
                <div class="control-group">
                    <h3>Upload Image</h3>
                    <div class="upload-area" id="uploadArea">
                        <i>📁</i>
                        <p>Drag & drop your image here or click to browse</p>
                        <p><small>Supports JPG, PNG, WebP (Max: 10MB)</small></p>
                        <button class="btn" id="browseBtn">
                            <i>📂</i> Browse Files
                        </button>
                        <input type="file" id="fileInput" class="hidden" accept="image/*">
                    </div>
                </div>
                
                <div class="control-group">
                    <h3>Resize Settings
                        <div class="tooltip">ℹ️
                            <span class="tooltiptext">Adjust dimensions or use presets. Enable aspect ratio lock to maintain proportions.</span>
                        </div>
                    </h3>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Width: <span id="widthValue">800</span>px</span>
                        </div>
                        <input type="range" min="100" max="2000" value="800" class="slider" id="widthSlider">
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Height: <span id="heightValue">600</span>px</span>
                        </div>
                        <input type="range" min="100" max="2000" value="600" class="slider" id="heightSlider">
                    </div>
                    
                    <div class="dimension-inputs">
                        <input type="number" class="dimension-input" id="widthInput" placeholder="Width" min="100" max="2000" value="800">
                        <input type="number" class="dimension-input" id="heightInput" placeholder="Height" min="100" max="2000" value="600">
                    </div>
                    
                    <div class="slider-container mt-2">
                        <div class="slider-label">
                            <span>Maintain Aspect Ratio</span>
                            <input type="checkbox" id="aspectRatio" checked>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Preset Sizes</span>
                        </div>
                        <div class="format-options">
                            <button class="format-btn" data-width="800" data-height="600">Web Large</button>
                            <button class="format-btn" data-width="400" data-height="300">Web Medium</button>
                            <button class="format-btn" data-width="200" data-height="150">Web Small</button>
                        </div>
                    </div>
                </div>
                
                <div class="control-group">
                    <h3>Compression Settings
                        <div class="tooltip">ℹ️
                            <span class="tooltiptext">Lower quality = smaller file size. WebP format offers best compression.</span>
                        </div>
                    </h3>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Quality: <span id="qualityValue">80</span>%</span>
                        </div>
                        <input type="range" min="10" max="100" value="80" class="slider" id="qualitySlider">
                    </div>
                    
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Output Format</span>
                        </div>
                        <div class="format-options">
                            <button class="format-btn active" data-format="image/jpeg">JPEG</button>
                            <button class="format-btn" data-format="image/png">PNG</button>
                            <button class="format-btn" data-format="image/webp">WebP</button>
                        </div>
                    </div>
                </div>
                
                <div class="loading" id="loadingIndicator">
                    <div class="spinner"></div>
                    <p>Processing your image...</p>
                </div>
                
                <button class="btn btn-download" id="downloadBtn" disabled>
                    <i>⬇️</i> Download Optimized Image
                </button>
            </div>
            
            <div class="image-preview">
                <div class="preview-container">
                    <div class="preview-box">
                        <h3><i>🖼️</i> Original Image</h3>
                        <div class="image-placeholder" id="originalPreview">
                            No image selected
                        </div>
                    </div>
                    
                    <div class="preview-box">
                        <h3><i>⚡</i> Optimized Image</h3>
                        <div class="image-placeholder" id="processedPreview">
                            Processed image will appear here
                        </div>
                    </div>
                </div>
                
                <div class="file-info">
                    <div class="info-item">
                        <div class="info-label">Original Size</div>
                        <div class="info-value" id="originalSize">0 KB</div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-label">Optimized Size</div>
                        <div class="info-value" id="processedSize">0 KB</div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-label">Size Reduction</div>
                        <div class="info-value reduction" id="reduction">0%</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="feature-highlights">
            <div class="feature">
                <i>🚀</i>
                <h3>Fast Processing</h3>
                <p>Resize and compress images in seconds</p>
            </div>
            <div class="feature">
                <i>🔒</i>
                <h3>Privacy First</h3>
                <p>Your images are processed locally in your browser</p>
            </div>
            <div class="feature">
                <i>💯</i>
                <h3>High Quality</h3>
                <p>Maintain visual quality while reducing file size</p>
            </div>
            <div class="feature">
                <i>📱</i>
                <h3>Mobile Friendly</h3>
                <p>Works perfectly on all devices</p>
            </div>
        </div>
        
        <div class="seo-content">
            <h2>Why Use Our Image Resizer & Compressor?</h2>
            <p>In today's digital landscape, website performance is crucial for user experience and search engine rankings. Large, unoptimized images can significantly slow down your website, leading to higher bounce rates and lower conversion rates. Our free online tool helps you optimize images for the web quickly and efficiently.</p>
            
            <h3>Benefits of Image Optimization</h3>
            <ul>
                <li><strong>Faster Loading Times:</strong> Compressed images load faster, improving user experience</li>
                <li><strong>Better SEO Performance:</strong> Google considers page speed as a ranking factor</li>
                <li><strong>Reduced Bandwidth Usage:</strong> Smaller images consume less data</li>
                <li><strong>Improved Mobile Experience:</strong> Optimized images load faster on mobile devices</li>
                <li><strong>Storage Savings:</strong> Reduced file sizes mean less server storage requirements</li>
            </ul>
            
            <h3>How to Optimize Images for Web</h3>
            <p>Follow these best practices when preparing images for your website:</p>
            <ul>
                <li>Choose the right file format (JPEG for photographs, PNG for graphics with transparency, WebP for modern browsers)</li>
                <li>Resize images to the exact dimensions needed on your website</li>
                <li>Use compression to reduce file size without noticeable quality loss</li>
                <li>Consider using responsive images with different sizes for different screen sizes</li>
                <li>Implement lazy loading for images below the fold</li>
            </ul>
            
            <h3>Common Use Cases</h3>
            <p>Our image resizer and compressor is perfect for:</p>
            <ul>
                <li>Website owners and developers optimizing site performance</li>
                <li>Bloggers and content creators preparing images for articles</li>
                <li>E-commerce stores with large product image catalogs</li>
                <li>Social media managers preparing images for multiple platforms</li>
                <li>Photographers sharing portfolio images online</li>
            </ul>
        </div>
        
        <footer>
            <p>© <span id="currentYear">2023</span> Image Resizer & Compressor | Free Online Tool for Web Optimization</p>
        </footer>
    </div>

    <script>
        // DOM elements
        const fileInput = document.getElementById('fileInput');
        const uploadArea = document.getElementById('uploadArea');
        const browseBtn = document.getElementById('browseBtn');
        const widthSlider = document.getElementById('widthSlider');
        const heightSlider = document.getElementById('heightSlider');
        const widthInput = document.getElementById('widthInput');
        const heightInput = document.getElementById('heightInput');
        const widthValue = document.getElementById('widthValue');
        const heightValue = document.getElementById('heightValue');
        const aspectRatioCheckbox = document.getElementById('aspectRatio');
        const qualitySlider = document.getElementById('qualitySlider');
        const qualityValue = document.getElementById('qualityValue');
        const downloadBtn = document.getElementById('downloadBtn');
        const originalPreview = document.getElementById('originalPreview');
        const processedPreview = document.getElementById('processedPreview');
        const originalSize = document.getElementById('originalSize');
        const processedSize = document.getElementById('processedSize');
        const reduction = document.getElementById('reduction');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const formatButtons = document.querySelectorAll('.format-btn[data-format]');
        const presetButtons = document.querySelectorAll('.format-btn[data-width]');
        const currentYearElement = document.getElementById('currentYear');

        // Set current year in footer
        currentYearElement.textContent = new Date().getFullYear();

        // State variables
        let originalImage = null;
        let originalImageSize = 0;
        let processedImageSize = 0;
        let aspectRatio = 1;
        let currentFormat = 'image/jpeg';

        // Event listeners
        browseBtn.addEventListener('click', () => fileInput.click());
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            if (e.dataTransfer.files.length) {
                handleImageUpload(e.dataTransfer.files[0]);
            }
        });
        
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                handleImageUpload(e.target.files[0]);
            }
        });

        widthSlider.addEventListener('input', updateDimensionsFromSlider);
        heightSlider.addEventListener('input', updateDimensionsFromSlider);
        widthInput.addEventListener('input', updateDimensionsFromInput);
        heightInput.addEventListener('input', updateDimensionsFromInput);
        aspectRatioCheckbox.addEventListener('change', updateAspectRatio);
        qualitySlider.addEventListener('input', updateQuality);
        downloadBtn.addEventListener('click', downloadImage);

        // Format buttons
        formatButtons.forEach(button => {
            button.addEventListener('click', () => {
                formatButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                currentFormat = button.getAttribute('data-format');
                processImage();
            });
        });

        // Preset buttons
        presetButtons.forEach(button => {
            button.addEventListener('click', () => {
                const width = button.getAttribute('data-width');
                const height = button.getAttribute('data-height');
                
                widthSlider.value = width;
                heightSlider.value = height;
                widthInput.value = width;
                heightInput.value = height;
                widthValue.textContent = width;
                heightValue.textContent = height;
                
                processImage();
            });
        });

        // Functions
        function handleImageUpload(file) {
            if (!file.type.match('image.*')) {
                alert('Please select an image file (JPG, PNG, WebP)');
                return;
            }

            if (file.size > 10 * 1024 * 1024) {
                alert('Please select an image smaller than 10MB');
                return;
            }

            // Display original image
            const reader = new FileReader();
            reader.onload = function(e) {
                originalImage = new Image();
                originalImage.onload = function() {
                    // Set initial dimensions
                    aspectRatio = originalImage.width / originalImage.height;
                    const initialWidth = Math.min(originalImage.width, 800);
                    const initialHeight = Math.min(originalImage.height, 600);
                    
                    widthSlider.value = initialWidth;
                    heightSlider.value = initialHeight;
                    widthInput.value = initialWidth;
                    heightInput.value = initialHeight;
                    widthValue.textContent = initialWidth;
                    heightValue.textContent = initialHeight;
                    
                    // Display original image
                    originalPreview.innerHTML = '';
                    originalPreview.appendChild(originalImage.cloneNode());
                    originalPreview.classList.add('has-image');
                    
                    // Store original file size
                    originalImageSize = file.size;
                    originalSize.textContent = formatFileSize(originalImageSize);
                    
                    // Process the image
                    processImage();
                    
                    // Enable download button
                    downloadBtn.disabled = false;
                };
                originalImage.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function updateDimensionsFromSlider() {
            const width = parseInt(widthSlider.value);
            const height = parseInt(heightSlider.value);
            
            widthValue.textContent = width;
            heightValue.textContent = height;
            widthInput.value = width;
            heightInput.value = height;
            
            if (aspectRatioCheckbox.checked) {
                if (this === widthSlider) {
                    const newHeight = Math.round(width / aspectRatio);
                    heightSlider.value = newHeight;
                    heightValue.textContent = newHeight;
                    heightInput.value = newHeight;
                } else {
                    const newWidth = Math.round(height * aspectRatio);
                    widthSlider.value = newWidth;
                    widthValue.textContent = newWidth;
                    widthInput.value = newWidth;
                }
            }
            
            processImage();
        }

        function updateDimensionsFromInput() {
            const width = parseInt(widthInput.value) || 100;
            const height = parseInt(heightInput.value) || 100;
            
            // Constrain values
            const constrainedWidth = Math.min(Math.max(width, 100), 2000);
            const constrainedHeight = Math.min(Math.max(height, 100), 2000);
            
            widthSlider.value = constrainedWidth;
            heightSlider.value = constrainedHeight;
            widthValue.textContent = constrainedWidth;
            heightValue.textContent = constrainedHeight;
            widthInput.value = constrainedWidth;
            heightInput.value = constrainedHeight;
            
            if (aspectRatioCheckbox.checked) {
                if (this === widthInput) {
                    const newHeight = Math.round(constrainedWidth / aspectRatio);
                    heightSlider.value = newHeight;
                    heightValue.textContent = newHeight;
                    heightInput.value = newHeight;
                } else {
                    const newWidth = Math.round(constrainedHeight * aspectRatio);
                    widthSlider.value = newWidth;
                    widthValue.textContent = newWidth;
                    widthInput.value = newWidth;
                }
            }
            
            processImage();
        }

        function updateAspectRatio() {
            if (aspectRatioCheckbox.checked && originalImage) {
                aspectRatio = originalImage.width / originalImage.height;
                updateDimensionsFromSlider();
            }
        }

        function updateQuality() {
            qualityValue.textContent = qualitySlider.value;
            processImage();
        }

        function processImage() {
            if (!originalImage) return;
            
            loadingIndicator.style.display = 'block';
            
            // Use setTimeout to allow UI to update before heavy processing
            setTimeout(() => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                // Set canvas dimensions
                canvas.width = parseInt(widthSlider.value);
                canvas.height = parseInt(heightSlider.value);
                
                // Draw image on canvas with new dimensions
                ctx.drawImage(originalImage, 0, 0, canvas.width, canvas.height);
                
                // Convert to data URL with specified quality
                let quality = parseInt(qualitySlider.value) / 100;
                if (currentFormat === 'image/png') {
                    // PNG doesn't use quality parameter
                    quality = undefined;
                }
                
                const dataURL = canvas.toDataURL(currentFormat, quality);
                
                // Display processed image
                const processedImage = new Image();
                processedImage.onload = function() {
                    processedPreview.innerHTML = '';
                    processedPreview.appendChild(processedImage);
                    processedPreview.classList.add('has-image');
                    
                    // Calculate and display file sizes
                    processedImageSize = calculateFileSize(dataURL);
                    processedSize.textContent = formatFileSize(processedImageSize);
                    
                    const reductionPercent = originalImageSize > 0 ? 
                        ((originalImageSize - processedImageSize) / originalImageSize * 100).toFixed(1) : 0;
                    reduction.textContent = `${reductionPercent}%`;
                    
                    loadingIndicator.style.display = 'none';
                };
                processedImage.src = dataURL;
            }, 100);
        }

        function downloadImage() {
            if (!originalImage) return;
            
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            // Set canvas dimensions
            canvas.width = parseInt(widthSlider.value);
            canvas.height = parseInt(heightSlider.value);
            
            // Draw image on canvas with new dimensions
            ctx.drawImage(originalImage, 0, 0, canvas.width, canvas.height);
            
            // Determine file extension
            let extension = 'jpg';
            if (currentFormat === 'image/png') extension = 'png';
            if (currentFormat === 'image/webp') extension = 'webp';
            
            // Convert to data URL with specified quality
            let quality = parseInt(qualitySlider.value) / 100;
            if (currentFormat === 'image/png') {
                quality = undefined;
            }
            
            const dataURL = canvas.toDataURL(currentFormat, quality);
            
            // Create download link
            const link = document.createElement('a');
            link.download = `optimized-image.${extension}`;
            link.href = dataURL;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function calculateFileSize(dataURL) {
            // Remove the data URL prefix to get the base64 string
            const base64String = dataURL.split(',')[1];
            // Calculate size in bytes
            return (base64String.length * 3) / 4;
        }

        function formatFileSize(bytes) {
            if (bytes < 1024) {
                return bytes + ' bytes';
            } else if (bytes < 1048576) {
                return (bytes / 1024).toFixed(1) + ' KB';
            } else {
                return (bytes / 1048576).toFixed(1) + ' MB';
            }
        }
    </script>
</body>
</html>
